<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YRN Luxury Receipt - Generator</title>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700;900&family=Montserrat:wght@300;400;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>

    <style>
        :root { --gold-rich: #c5a059; --gold-dark: #8a6e2f; --ink: #1a1a1a; --paper: #fdf8e4; --sidebar-bg: #111; }
        body { background-color: #222; font-family: 'Montserrat', sans-serif; margin: 0; display: flex; height: 100vh; overflow: hidden; }
        .controls { width: 380px; background: var(--sidebar-bg); color: #ddd; padding: 25px; overflow-y: auto; border-right: 1px solid #444; display: flex; flex-direction: column; gap: 15px; }
        .controls h2 { font-family: 'Cinzel', serif; color: var(--gold-rich); text-align: center; border-bottom: 1px solid #444; padding-bottom: 15px; }
        .input-group label { display: block; font-size: 0.7rem; color: #aaa; text-transform: uppercase; margin-bottom: 5px; }
        input, textarea { width: 100%; padding: 10px; background: #252525; border: 1px solid #444; color: #fff; border-radius: 2px; }
        .btn-group { display: flex; gap: 10px; margin-top: 10px; }
        button { flex: 1; padding: 12px; cursor: pointer; font-family: 'Cinzel', serif; font-weight: 700; text-transform: uppercase; }
        .btn-print { background: #fff; color: #000; }
        .btn-pdf { background: linear-gradient(135deg, var(--gold-rich), var(--gold-dark)); color: #fff; }
        .preview-area { flex: 1; background: #555; display: flex; justify-content: center; align-items: center; padding: 20px; overflow: auto; }
        #receipt-container { width: 210mm; height: 296mm; position: relative; background-color: var(--paper); color: var(--ink); box-shadow: 0 10px 50px rgba(0,0,0,0.5); }
        .border-frame { position: absolute; top: 10mm; left: 10mm; right: 10mm; bottom: 10mm; border: 2px solid var(--gold-rich); padding: 15mm; display: flex; flex-direction: column; }
        header { text-align: center; margin-bottom: 25px; }
        .brand { font-family: 'Cinzel', serif; font-size: 2.8rem; font-weight: 900; margin: 0; }
        .contact-container { border-top: 1px solid var(--gold-rich); border-bottom: 1px solid var(--gold-rich); padding: 10px 0; margin-top: 15px; }
        .info-section { display: flex; justify-content: space-between; margin-top: 20px; }
        .col h3 { font-family: 'Cinzel', serif; color: var(--gold-dark); border-bottom: 1px solid rgba(0,0,0,0.1); }
        .price-section { text-align: right; margin-top: 25px; }
        .price-val { font-family: 'Cinzel', serif; font-size: 2.2rem; font-weight: 800; }
        .auth-row { border-top: 2px solid var(--gold-rich); padding-top: 10px; display: flex; justify-content: flex-end; align-items: center; gap: 20px; margin-top: auto;}
        #qrcode { background: white; padding: 5px; border: 1px solid var(--gold-rich); }
        @media print { .controls { display: none; } body { background: white; } #receipt-container { box-shadow: none; } }
    </style>
</head>
<body>
    <div class="controls">
        <h2>YRN Generator</h2>
        <div class="input-group"><label>Display Link (For QR)</label>
        <input type="text" id="i-web" value="https://hannas04.github.io/yrn-receipt/display.html" oninput="upd()"></div>
        <div class="input-group"><label>Customer Name</label><input type="text" id="i-name" value="Emeka Okafor" oninput="upd()"></div>
        <div class="input-group"><label>Product Name</label><input type="text" id="i-item" value="Diamond Cuban Link" oninput="upd()"></div>
        <div class="input-group"><label>Amount (₦)</label><input type="text" id="i-price" value="₦3,000,000.00" oninput="upd()"></div>
        <div class="input-group"><label>Transaction ID</label><input type="text" id="i-id" value="YRN-9920" oninput="upd()"></div>
        <div class="btn-group">
            <button class="btn-print" onclick="window.print()">Print</button>
            <button class="btn-pdf" onclick="savePDF()">PDF</button>
        </div>
    </div>

    <div class="preview-area">
        <div id="receipt-container">
            <div class="border-frame">
                <header>
                    <h1 class="brand">YRN THE JEWELLER</h1>
                    <div class="contact-container">
                        <div id="o-addr" style="font-size:0.7rem">SHOP (G-022E) GROUND, Yaba, Lagos</div>
                    </div>
                </header>
                <div class="info-section">
                    <div class="col"><h3>Customer</h3><div class="val" id="o-name">...</div></div>
                    <div class="col" style="text-align:right"><h3>Details</h3><div class="val" id="o-id">...</div></div>
                </div>
                <div style="margin-top:40px">
                    <div id="o-item" style="font-size:1.5rem; font-weight:bold">...</div>
                </div>
                <div class="price-section">
                    <div class="price-val" id="o-price">...</div>
                </div>
                <div class="auth-row">
                    <div style="font-family:'Cinzel'; color:var(--gold-dark)">OFFICIAL SEAL</div>
                    <div id="qrcode"></div>
                </div>
            </div>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getDatabase, ref, set } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";
        
        // TEMPORARY TEST DATABASE (Replace with yours later)
        const firebaseConfig = { databaseURL: "https://yrn-luxury-default-rtdb.firebaseio.com/" };
        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);

        window.broadcastData = function() {
            set(ref(db, 'liveReceipt'), {
                name: document.getElementById('i-name').value,
                item: document.getElementById('i-item').value,
                price: document.getElementById('i-price').value
            });
        };
    </script>

    <script>
        let qrcode = new QRCode(document.getElementById("qrcode"), { width: 80, height: 80 });
        function upd() {
            document.getElementById('o-name').innerText = document.getElementById('i-name').value;
            document.getElementById('o-item').innerText = document.getElementById('i-item').value;
            document.getElementById('o-price').innerText = document.getElementById('i-price').value;
            document.getElementById('o-id').innerText = document.getElementById('i-id').value;
            qrcode.makeCode(document.getElementById('i-web').value);
            if (window.broadcastData) window.broadcastData();
        }
        function savePDF() {
            const element = document.getElementById('receipt-container');
            html2pdf().from(element).save('YRN_Receipt.pdf');
        }
        upd();
    </script>
</body>
</html>